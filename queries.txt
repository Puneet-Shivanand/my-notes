
****
SELECT DISTINCT rsid, pmid ,count(*) FROM HGVD group by RSID having COUNT(*) > 1;

 select * from HGVD where pmid='22393390';

select RSID, PMID, DescriptorUI from HGVD where DescriptorUI='D003376' limit 10;

select t1.DescriptorUI, t2.TreeNumber from (SELECT DISTINCT rsid, pmid ,count(*), DescriptorUI FROM HGVD group by RSID having COUNT(*) > 1 limit 50) as t1, (select H.DescriptorUI, M.TreeNumber from HGVD H, MeshC M where H.DescriptorUI=M.DescriptorUI limit 50) as t2 group by t2.TreeNumber;


select t1.DescriptorUI, t2.TreeNumber from (SELECT DISTINCT rsid, pmid ,count(*), DescriptorUI FROM HGVD group by RSID having COUNT(*) > 1 limit 500) as t1, (select H.DescriptorUI, M.TreeNumber from HGVD H, MeshC M where H.DescriptorUI=M.DescriptorUI limit 500) as t2 group by t2.TreeNumber
    -> INTO OUTFILE '/tmp/OP.csv'
    -> FIELDS TERMINATED BY ','
    -> LINES TERMINATED BY '\n';



*

SELECT DISTINCT id, rsid, pmid, DescriptorUI FROM HGVD WHERE pmid > 1 limit 500;


select M.DescriptorUI, M.TreeNumber from MeshC M, HGVD H where M.DescriptorUI = H.DescriptorUI in (' + ','.join(map(str, a)) + ') limit 10;

select t1.RSID, t1.PMID, t1.DescriptorUI, t2.TreeNumber from (select DISTINCT rsid, pmid, DescriptorUI from HGVD where pmid>1 limit 5000) as t1, (select M.DescriptorUI, M.TreeNumber from MeshC M, HGVD H where M.DescriptorUI = H.DescriptorUI limit 5000) as t2 where t1.DescriptorUI = t2.DescriptorUI GROUP BY RSID having count(*)>1;


select * from MeshC where DescriptorUI='D003376'


select TreeNumber from MeshC
    -> INNER JOIN HGVD ON HGVD.DescriptorUI = MeshC.DescriptorUI
    -> where HGVD.DescriptorUI IN(select DISTINCT RSID, PMID from HGVD) limit 500;

######
select H.DescriptorUI, M.TreeNumber from   HGVD H, MeshC M where  H.DescriptorUI = M.DescriptorUI group by H.RSID, H.PMID limit 5;

select RSID, PMID, DescriptorUI from HGVD where DescriptorUI='D010300' limit 5;

select H.DescriptorUI, H.RSID, H.PMID, M.TreeNumber from HGVD H, MeshC M where  H.DescriptorUI = M.DescriptorUI group by H.RSID,H.PMID





